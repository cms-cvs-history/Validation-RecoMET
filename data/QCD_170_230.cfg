process P  = 
{
   include "Configuration/ReleaseValidation/data/Services.cfi"
   include "FWCore/MessageLogger/data/MessageLogger.cfi"
   include "IOMC/EventVertexGenerators/data/VtxSmearedGauss.cfi"
   include "SimG4Core/Application/data/SimG4Object.cfi"
#   include "SimG4Core/Application/data/SIM-DIGIWithEcalZeroSuppression.cff"
   include "Configuration/JetMET/data/calorimetry-digitization.cff"
   include "Configuration/EventContent/data/FEVTOutput.cff"
   include "RecoMET/METProducers/data/GenMET.cfi"
   include "RecoMET/METProducers/test/CaloCandidatesFromDigis.cfi"
   include "RecoMET/METProducers/data/CaloMET.cfi"
   include "Validation/RecoMET/data/source/PythiaSource-QCD_170_230.cff"
   replace PythiaSource.maxEvents = 2

   es_module = TrackerGeometricDetESModule {}

   service = DaqMonitorROOTBackEnd{ }
   module metAnalyzer = METTester
   {
      string InputGenMETLabel  = 'genMet'
      string InputCaloMETLabel = 'met'
      untracked string outputFile = 'RecoMETValidation-QCD_170_230.root'
      double CaloMExResFitMin           = 770.0
      double CaloMExResFitMax           = 1800.0
      int32  CaloMExResHistoSumETNumBin = 10
      double CaloMExResHistoLowSumET    = 770.0
      double CaloMExResHistoHighSumET   = 1800.0
      int32  CaloMExResHistoMExNumBin   = 10
      double CaloMExResHistoLowMEx      = -199.0
      double CaloMExResHistoHighMEx     = 200.0
   }
   service = RandomNumberGeneratorService
   {
      untracked uint32 sourceSeed = 135799753
      PSet moduleSeeds = { untracked uint32 VtxSmeared = 12345678 }
   }
   module GEN-SIM-DIGI-RECO = PoolOutputModule 
   {
      untracked string fileName = "QCD_170_230.root"
      untracked uint32 commitInterval = 10
      #using FEVTOutput
      untracked vstring outputCommands = 
      {
         "drop *",
         "keep *_caloTowers_*_*",
         "keep recoCaloMETs_*_*_*",
         "keep recoGenMETs_*_*_*"
      }
   }
#   path p1  = { VtxSmeared, doG4SimHitsDigiEcalZeroSup }
   path p1   = { VtxSmeared, g4SimHits }
   path p2   = { caloDigi }
   path p3   = { genCandidatesForMET, genMet, caloCandidatesForMET, met }
   path p4   = { metAnalyzer }
   endpath e = { GEN-SIM-DIGI-RECO }
   schedule  = {p1, p2, p3, p4, e}
}
